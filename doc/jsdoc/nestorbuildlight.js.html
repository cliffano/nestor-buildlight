<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nestorbuildlight.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="NestorBuildLight.html">NestorBuildLight</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NestorBuildLight.html#notify">notify</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#exec">exec</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">nestorbuildlight.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict"
import BuildLight from 'buildlight';

/**
 * class NestorBuildLight
 *
 * @param {String} opts: optional
 * - map: status-colour map, defaults to { OK: 'green', FAIL: 'red', WARN: 'blue' }
 * - scheme: color scheme array, defaults to [ 'red', 'green', 'blue' ]
 *           scheme allows flexibility to use BuildLight with various Delcom devices (RGB, RGY)
 * - usbled: path to usbled installation, if not specified then it will try to
 *           find a usbled installation at /sys/bus/usb/drivers/usbled/
 * - platform: override platform, used by unit tests to override buildlight platform
 * - blinkOnFailure: if true then build light will display blinking red, otherwise display red without blinking 
 */
class NestorBuildLight {
  
  constructor(opts) {
    this.opts = opts;
    this.opts.scheme = this.opts.scheme || ['red', 'green', 'blue'];

    const MAP = {
      ok: 'green',
      fail: 'red',
      warn: this.opts.scheme.indexOf('blue') !== -1 ? 'blue' : 'yellow'
    };
    this.opts.map = this.opts.map || MAP;
    this.buildLight  = new BuildLight(this.opts);
  }

  /**
   * Notify build status as a colour on Delcom USB Visual Indocator build light.
   * Device color schemes contain red and green, which are used for OK and FAIL statuses.
   * While blue or yellow is used to represent a WARN.
   * Unknown/other status will be represented as all colors switched on.
   *
   * @param {String} status: build status
   */
  notify(status) {
    const UNKNOWN = 'on';
    const colour = this.opts.map[status] || UNKNOWN;
    const self = this;

    function _colourise() {
      console.log('Setting build light colour to %s for status %s', colour, status);
      if (self.opts.blinkOnFailure &amp;&amp; status === 'fail') {
        self.buildLight.blink(colour, function (err) {
          if (err) {
            console.error(err.message);
          }
        });
      } else {
        self.buildLight[colour]();
      }
    }

    this.buildLight.unblink(_colourise);
  }
}

export {
  NestorBuildLight as default
};</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on Wed Jan 04 2023 01:52:44 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
